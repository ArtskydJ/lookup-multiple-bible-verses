{"version":3,"file":"bundle.js","sources":["src/node_modules/flatmap/index.js","src/node_modules/regex-fun/regex-source.js","src/node_modules/regex-fun/is-atomic.js","src/node_modules/regex-fun/index.js","src/node_modules/verse-reference-regex/create-chapter-verse-range-regex.js","src/node_modules/verse-reference-regex/create-regex.js","src/node_modules/verse-reference-regex/extract-range-from-match.js","src/js/extract_ranges_from_text.js","src/js/canonapiv1.js","src/js/fetch_bible_passage_from_range.js","src/js/app.js"],"sourcesContent":["\"use strict\";\n\nmodule.exports = function(arr, iter, context) {\n  var results = [];\n  if (!Array.isArray(arr)) return results;\n  arr.forEach(function(value, index, list) {\n    var res = iter.call(context, value, index, list);\n    if (Array.isArray(res)) {\n      results.push.apply(results, res);\n    } else if (res != null) {\n      results.push(res);\n    }\n  });\n  return results;\n};","module.exports = regex => regex instanceof RegExp ? regex.source : regex\n","const regexSource = require(`./regex-source.js`)\n\nconst closingCharacters = {\n\t'(': `)`,\n\t'[': `]`,\n}\n\nmodule.exports = function isAtomic(regex) {\n\tconst string = regexSource(regex)\n\n\treturn /^\\w$/.test(string) || enclosedByTopLevelCharacters(string)\n}\n\nfunction enclosedByTopLevelCharacters(string) {\n\tconst openingCharacter = string[0]\n\tconst closingCharacter = closingCharacters[openingCharacter]\n\n\n\tconst closedByAppropriateCharacter = closingCharacter !== undefined\n\t\t&& string[string.length - 1] === closingCharacter\n\n\n\tif (!closedByAppropriateCharacter) {\n\t\treturn false\n\t}\n\n\treturn !isClosedBeforeEndOfString(string, openingCharacter, closingCharacter)\n}\n\n\nfunction isClosedBeforeEndOfString(string, openingCharacter, closingCharacter) {\n\tlet depth = 0\n\n\tfor (let characterIndex = 0; characterIndex < string.length - 1; ++characterIndex) {\n\t\tdepth = calculateNewDepth(depth, openingCharacter, closingCharacter, string[characterIndex])\n\t\tif (depth === 0) {\n\t\t\treturn true\n\t\t}\n\t}\n\n\treturn false\n}\n\nfunction calculateNewDepth(previousDepth, openingCharacter, closingCharacter, character) {\n\tif (character === openingCharacter) {\n\t\treturn previousDepth + 1\n\t} else if (character === closingCharacter) {\n\t\treturn previousDepth - 1\n\t} else {\n\t\treturn previousDepth\n\t}\n}\n","const isAtomic = require(`./is-atomic.js`)\nconst regexSource = require(`./regex-source.js`)\n\nconst combine = returnsRegex((...args) => escapeInputForCombining(...args).join(``))\nconst guaranteeAtomic = regex => isAtomic(regex) ? regex : `(?:${regexSource(regex)})`\nconst escapeRegex = str => str.replace(/[.?*+^$[\\]\\\\(){}|-]/g, `\\\\$&`)\nconst ifRegex = (input, ifCase, elseIfCase) => input instanceof RegExp ? ifCase(input) : elseIfCase(input)\nconst escapeInputAndReturnString = regex => ifRegex(regex, regex => regex.source, escapeRegex)\n\nmodule.exports = {\n\tcombine,\n\teither: makeJoiningFunction(`(?:`, `|`, `)`),\n\tcapture: makeJoiningFunction(`(`, ``, `)`),\n\n\tflags: (flags, ...args) => new RegExp(combine(...args).source, flags),\n\n\tanyNumber: suffix(`*`),\n\toneOrMore: suffix(`+`),\n\toptional: suffix(`?`),\n\texactly: (n, ...regexes) => suffix(`{${n}}`)(...regexes),\n\tatLeast: (n, ...regexes) => suffix(`{${n},}`)(...regexes),\n\tbetween: (n, m, ...regexes) => suffix(`{${n},${m}}`)(...regexes),\n\n\tanyNumberNonGreedy: suffix(`*?`),\n\toneOrMoreNonGreedy: suffix(`+?`),\n\toptionalNonGreedy: suffix(`??`),\n\texactlyNonGreedy: (n, ...regexes) => suffix(`{${n}}?`)(...regexes),\n\tatLeastNonGreedy: (n, ...regexes) => suffix(`{${n},}?`)(...regexes),\n\tbetweenNonGreedy: (n, m, ...regexes) => suffix(`{${n},${m}}?`)(...regexes),\n}\n\nfunction removeNonCapturingGroupIfExists(regexString) {\n\tconst match = /^\\(\\?:(.+)\\)$/.exec(regexString)\n\treturn match ? match[1] : regexString\n}\n\nfunction guaranteeNoTopLevelOrs(regexString) {\n\treturn regexString.indexOf(`|`) >= 0 ? guaranteeAtomic(regexString) : regexString\n}\n\nfunction escapeInputForCombining(...args) {\n\treturn args.map(escapeInputAndReturnString).map(guaranteeNoTopLevelOrs)\n}\n\nfunction returnsRegex(fn) {\n\treturn (...args) => ifRegex(fn(...args), regex => regex, input => new RegExp(input))\n}\n\nfunction makeJoiningFunction(openingCharacter, joinCharacter, closingCharacter) {\n\treturn returnsRegex((...args) => {\n\t\tconst naiveBody = escapeInputForCombining(...args).join(joinCharacter)\n\t\tconst body = isAtomic(naiveBody) ? removeNonCapturingGroupIfExists(naiveBody) : naiveBody\n\n\t\treturn concat(openingCharacter, body, closingCharacter)\n\t})\n}\n\nfunction suffix(appendCharacter) {\n\treturn returnsRegex((...args) => concat(guaranteeAtomic(combine(...args)), appendCharacter))\n}\n\nfunction concat(...regexes) {\n\treturn regexes.map(regexSource).join(``)\n}\n","const {\n\tcombine,\n\tflags,\n\teither,\n\toptional,\n} = require('regex-fun')\n\nmodule.exports = function createChapterVerseRangeRegex({\n\trequireVerse = false,\n\tflags: regexFlags = 'i',\n} = {}) {\n\tconst number = /(\\d+)/\n\tconst numberAndOptionalLetter = /(\\d+)([a-z])?/\n\tconst colonVerse = combine(':', numberAndOptionalLetter)\n\tconst chapterAndVerse = combine(number, requireVerse ? colonVerse : optional(colonVerse))\n\n\tconst secondHalfOfRange = combine('-', either(/([a-z])/, /(\\d+)([a-z])/, chapterAndVerse, numberAndOptionalLetter))\n\n\treturn flags(regexFlags, chapterAndVerse, optional(secondHalfOfRange))\n}\n","const flatmap = require('flatmap')\nconst {\n\teither,\n\tcapture,\n\tflags,\n} = require('regex-fun')\n\nconst canonBooks = require('books-of-the-bible')\n\nconst chapterVerseRange = require('./create-chapter-verse-range-regex.js')\n\nmodule.exports = function createRegex({\n\trequireVerse = false,\n\tflags: regexFlags = 'i',\n\tbooks = canonBooks,\n} = {}) {\n\tconst bookNames = books.map(({ name }) => name)\n\tconst abbreviations = flatmap(books, ({ aliases }) => {\n\t\treturn flatmap(aliases, alias => [ alias, alias + '.' ])\n\t})\n\n\tconst range = chapterVerseRange({ requireVerse, flags: regexFlags })\n\n\treturn flags(\n\t\tregexFlags,\n\t\tcapture(either(...bookNames, ...abbreviations)),\n\t\t' ',\n\t\trange\n\t)\n}\n\n","const canonBooks = require('books-of-the-bible')\n\nconst mapOfAliasesToCanonBookNames = makeMapOfAliases(canonBooks)\n\nconst valueOr = (value, defaultValue) => value === undefined\n\t? evaluate(defaultValue)\n\t: value\nconst ifelse = (predicate, truthyCase, falsyCase) => evaluate(predicate)\n\t? evaluate(truthyCase)\n\t: evaluate(falsyCase)\n\nconst valueOrNull = value => valueOr(value, null)\nconst evaluate = value => typeof value === 'function' ? value() : value\nconst int = value => value === null ? value : parseInt(value, 10)\nconst stripPeriod = str => str[str.length - 1] === '.' ? str.substr(0, str.length - 1) : str\nconst isSection = str => /[a-z]/.test(str)\n\n\nmodule.exports = extractRangeFromMatch\n\nfunction extractRangeFromMatch(match, books) {\n\tconst mapOfAliasesToBookNames = books ? makeMapOfAliases(books) : mapOfAliasesToCanonBookNames\n\tconst [ , matchBook, matchStartChapter, matchStartVerse, matchStartSection, ...matchTail ] = match\n\tconst rangeEndValues = matchTail.filter(value => value !== undefined)\n\n\tconst start = {\n\t\tchapter: int(valueOrNull(matchStartChapter)),\n\t\tverse: int(valueOrNull(matchStartVerse)),\n\t\tsection: valueOrNull(matchStartSection),\n\t}\n\n\tconst end = ifelse(rangeEndValues.length === 3, () => {\n\t\tconst [ chapter, verse, section ] = rangeEndValues\n\t\treturn {\n\t\t\tchapter: int(chapter),\n\t\t\tverse: int(verse),\n\t\t\tsection: valueOrNull(section),\n\t\t}\n\t}, () => {\n\t\tconst { numbers, section } = separateSectionFromNumbers(rangeEndValues)\n\n\t\tif (numbers.length === 2) {\n\t\t\tconst [ chapter, verse ] = numbers\n\t\t\treturn {\n\t\t\t\tchapter,\n\t\t\t\tverse,\n\t\t\t\tsection,\n\t\t\t}\n\t\t} else if (numbers.length === 1) {\n\t\t\tconst rangeIsChapter = start.verse === null\n\n\t\t\treturn rangeIsChapter ? {\n\t\t\t\tchapter: numbers[0],\n\t\t\t\tverse: null,\n\t\t\t\tsection,\n\t\t\t} : {\n\t\t\t\tchapter: start.chapter,\n\t\t\t\tverse: numbers[0],\n\t\t\t\tsection,\n\t\t\t}\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tchapter: start.chapter,\n\t\t\t\tverse: start.verse,\n\t\t\t\tsection: section || start.section,\n\t\t\t}\n\t\t}\n\t})\n\n\treturn {\n\t\tbook: mapOfAliasesToBookNames[stripPeriod(matchBook).toLowerCase()].name,\n\t\tstart,\n\t\tend,\n\t}\n}\n\nmodule.exports.chapterVerseRange = match => {\n\tconst [ , ...rest ] = match\n\tconst books = [{\n\t\tname: '',\n\t\taliases: [],\n\t}]\n\treturn Object.assign(\n\t\textractRangeFromMatch([ null, '', ...rest ], books),\n\t\t{ book: null }\n\t)\n}\n\n\nfunction separateSectionFromNumbers(ary) {\n\tconst lastValue = ary[ary.length - 1]\n\n\tif (ary.length > 0 && isSection(lastValue)) {\n\t\treturn {\n\t\t\tnumbers: ary.slice(0, ary.length - 1).map(int),\n\t\t\tsection: lastValue,\n\t\t}\n\t} else {\n\t\treturn {\n\t\t\tnumbers: ary.map(int),\n\t\t\tsection: null,\n\t\t}\n\t}\n}\n\nfunction makeMapOfAliases(books) {\n\treturn books.reduce((map, book) => {\n\t\tmap[book.name.toLowerCase()] = book\n\t\tbook.aliases.forEach(alias => map[alias.toLowerCase()] = book)\n\t\treturn map\n\t}, Object.create(null))\n}\n","const { createRegex, createChapterVerseRangeRegex, extractRangeFromMatch } = require('verse-reference-regex')\r\n// import { createChapterVerseRangeRegex, extractRangeFromMatch } from 'verse-reference-regex'\r\n\r\n\r\nconst cvr_all = createRegex({ flags: 'gi' })\r\n\r\nexport default function extract_references_from_text(text) {\r\n\tconst matches = [ ...text.matchAll(cvr_all) ]\r\n\r\n\t// console.log(matches)\r\n\r\n\tconst ranges = matches.map(match => extractRangeFromMatch(match))\r\n\r\n\tranges.forEach(range => {\r\n\t\tconst { start, end } = range\r\n\r\n\t\tif (end.chapter < start.chapter) {\r\n\t\t\tthrow new Error('invalid chapter range')\r\n\t\t}\r\n\r\n\t\tif (end.chapter === start.chapter && end.verse < start.verse) {\r\n\t\t\tthrow new Error('invalid verse range')\r\n\t\t}\r\n\r\n\t\tconsole.log(JSON.stringify(range))\r\n\t})\r\n\r\n\treturn ranges\r\n}\r\n","const books = require('books-of-the-bible')\r\n\r\nconst cache_clearing_handled = fetch('https://www.canonapi.com/v1/last_update.json')\r\n\t.then(res => res.text())\r\n\t.then(last_update => {\r\n\t\tconst cached_version = localStorage.getItem('last_update')\r\n\t\tif (cached_version !== last_update) {\r\n\t\t\tlocalStorage.clear()\r\n\t\t\tlocalStorage.setItem('last_update', last_update)\r\n\t\t\t// console.log('cleared cache')\r\n\t\t} else {\r\n\t\t\t// console.log('keeping cache')\r\n\t\t}\r\n\t})\r\n\r\nfunction normalize(book) {\r\n\treturn book.toLowerCase().replace(/ /g, '').trim()\r\n}\r\n\r\nfunction fetch_cached(book, chapter) {\r\n\tconst normalized_book = normalize(book)\r\n\tconst valid_book = books.find(({ name, aliases }) => [ name, ...aliases ].map(normalize).includes(normalized_book))\r\n\tconst book_name = valid_book && valid_book.name\r\n\r\n\treturn cache_clearing_handled.then(() => {\r\n\t\tif (book_name) {\r\n\t\t\tconst key = normalize(book_name) + chapter\r\n\t\t\tconst cached = localStorage.getItem(key)\r\n\t\t\tif (cached) {\r\n\t\t\t\treturn Promise.resolve({ // THESE SHOULD MATCH\r\n\t\t\t\t\tverses: JSON.parse(cached),\r\n\t\t\t\t\tbook_name,\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\treturn fetch(`https://www.canonapi.com/v1/${ normalize(book_name) }/${ chapter }.json`)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tif (! res.ok) {\r\n\t\t\t\t\t\tthrow new Error(`Invalid chapter: ${ book_name } ${ chapter }`)\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn res.text()\r\n\t\t\t\t})\r\n\t\t\t\t.then(text => {\r\n\t\t\t\t\tlocalStorage.setItem(key, text)\r\n\t\t\t\t\treturn { // THESE SHOULD MATCH\r\n\t\t\t\t\t\tverses: JSON.parse(text),\r\n\t\t\t\t\t\tbook_name,\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t}\r\n\t\treturn Promise.reject(new Error(`Invalid book: ${ book }`))\r\n\t})\r\n}\r\n\r\nexport default fetch_cached\r\n","import canonapiv1 from './canonapiv1.js'\n\nfunction number_range(start, end) {\n\tif (end < start) {\n\t\tthrow new RangeError('start must be less than end')\n\t}\n\treturn new Array(end - start + 1).fill().map((_, i) => start + i)\n}\n\nexport default async function fetch_bible_passage_from_range(range) {\n\tconst { book, start, end } = range\n\n\tconst chapter_numbers = number_range(start.chapter, end.chapter)\n\n\tconst chapters_text = await Promise.all(\n\t\tchapter_numbers.map(async chapter_number => {\n\t\t\tconst { verses } = await canonapiv1(book, chapter_number)\n\n\t\t\tlet slice_start = 0\n\t\t\tif (start.chapter === chapter_number && start.verse) {\n\t\t\t\tslice_start = start.verse - 1\n\t\t\t}\n\t\t\tlet slice_end = Infinity\n\t\t\tif (end.chapter === chapter_number && end.verse) {\n\t\t\t\tslice_end = end.verse\n\t\t\t}\n\n\t\t\tif (verses.length <= slice_start) {\n\t\t\t\tthrow new Error(`Invalid verse: ${ book } ${ chapter_number }:${ slice_start + 1 }`)\n\t\t\t}\n\n\t\t\tif (verses.length < slice_end && slice_end !== Infinity) {\n\t\t\t\tconst prefix = slice_end > verses.length + 1 ? verses.length + 1 + '-' : ''\n\t\t\t\tthrow new Error(`Invalid verse${ prefix ? 's' : '' }: ${ book } ${ chapter_number }:${ prefix }${ slice_end }`)\n\t\t\t}\n\n\t\t\tconst text = verses.slice(slice_start, slice_end).join('')\n\n\t\t\treturn text\n\t\t}),\n\t)\n\n\tlet reference = book + ' ' + start.chapter\n\tif (start.verse) {\n\t\treference += ':' + start.verse\n\t}\n\tif (start.chapter !== end.chapter) {\n\t\treference += '-' + end.chapter\n\t\tif (end.verse) {\n\t\t\treference += ':' + end.verse\n\t\t}\n\t} else if (end.verse && end.verse !== start.verse) {\n\t\treference += '-' + end.verse\n\t}\n\n\treturn {\n\t\treference,\n\t\ttext: chapters_text.join(''),\n\t}\n}\n","import extract_ranges_from_text from './extract_ranges_from_text.js'\r\nimport fetch_bible_passage_from_range from './fetch_bible_passage_from_range.js'\r\n\r\nconst textarea = document.querySelector('textarea')\r\nconst output = document.querySelector('div.output')\r\n\r\nasync function refresh() {\r\n\tconst text = textarea.value\r\n\r\n\tconst ranges = extract_ranges_from_text(text)\r\n\r\n\tconst html_chunks = await Promise.all(\r\n\t\tranges.map(async range => {\r\n\t\t\ttry {\r\n\t\t\t\tconst { reference, text } = await fetch_bible_passage_from_range(range)\r\n\t\t\t\treturn `<span class=\"verse\"><span class=\"ref\">${ reference }</span>${ text }</span>`\r\n\t\t\t} catch (e) {\r\n\t\t\t\treturn `<span class=\"err\">${ e.message }</span>`\r\n\t\t\t}\r\n\t\t}),\r\n\t)\r\n\r\n\toutput.innerHTML = html_chunks.join('')\r\n}\r\n\r\ntextarea.oninput = refresh\r\n\r\nrefresh()\r\n"],"names":["regexSource","regex","RegExp","source","require$$0","closingCharacters","calculateNewDepth","previousDepth","openingCharacter","closingCharacter","character","isAtomic","string","test","undefined","length","depth","characterIndex","isClosedBeforeEndOfString","enclosedByTopLevelCharacters","require$$1","combine","returnsRegex","args","escapeInputForCombining","join","guaranteeAtomic","escapeRegex","str","replace","ifRegex","input","ifCase","elseIfCase","escapeInputAndReturnString","regexFun","either","makeJoiningFunction","capture","flags","anyNumber","suffix","oneOrMore","optional","exactly","n","regexes","atLeast","between","m","anyNumberNonGreedy","oneOrMoreNonGreedy","optionalNonGreedy","exactlyNonGreedy","atLeastNonGreedy","betweenNonGreedy","guaranteeNoTopLevelOrs","regexString","indexOf","map","fn","joinCharacter","naiveBody","body","match","exec","removeNonCapturingGroupIfExists","concat","appendCharacter","createChapterVerseRangeRegex","requireVerse","regexFlags","numberAndOptionalLetter","colonVerse","chapterAndVerse","secondHalfOfRange","flatmap","arr","iter","context","results","Array","isArray","forEach","value","index","list","res","call","push","apply","canonBooks","require$$2","chapterVerseRange","require$$3","mapOfAliasesToCanonBookNames","makeMapOfAliases","valueOrNull","defaultValue","evaluate","valueOr","int","parseInt","extractRangeFromMatch","books","mapOfAliasesToBookNames","matchBook","matchStartChapter","matchStartVerse","matchStartSection","matchTail","rangeEndValues","filter","start","chapter","verse","section","end","predicate","truthyCase","falsyCase","numbers","ary","lastValue","slice","separateSectionFromNumbers","book","substr","toLowerCase","name","reduce","aliases","alias","Object","create","extractRangeFromMatch$2","exports","extractRangeFromMatch_1","rest","assign","bookNames","abbreviations","range","createRegex","cvr_all","cache_clearing_handled","fetch","then","text","last_update","localStorage","getItem","clear","setItem","normalize","trim","async","fetch_bible_passage_from_range","chapter_numbers","RangeError","fill","_","i","number_range","chapters_text","Promise","all","verses","normalized_book","valid_book","find","includes","book_name","key","cached","resolve","JSON","parse","ok","Error","reject","canonapiv1","chapter_number","slice_start","slice_end","Infinity","prefix","reference","textarea","document","querySelector","output","refresh","ranges","matchAll","console","log","stringify","extract_ranges_from_text","html_chunks","e","message","innerHTML","oninput"],"mappings":"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"}