!function(){"use strict";var e=e=>e instanceof RegExp?e.source:e;const a=e,n={"(":")","[":"]"};function s(e,a,n,s){return s===a?e+1:s===n?e-1:e}const t=function(e){const t=a(e);return/^\w$/.test(t)||function(e){const a=e[0],t=n[a];if(void 0===t||e[e.length-1]!==t)return!1;return!function(e,a,n){let t=0;for(let r=0;r<e.length-1;++r)if(t=s(t,a,n,e[r]),0===t)return!0;return!1}(e,a,t)}(t)},r=e,o=d(((...e)=>p(...e).join(""))),i=e=>t(e)?e:`(?:${r(e)})`,l=e=>e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&"),c=(e,a,n)=>e instanceof RegExp?a(e):n(e),m=e=>c(e,(e=>e.source),l);var h={combine:o,either:f("(?:","|",")"),capture:f("(","",")"),flags:(e,...a)=>new RegExp(o(...a).source,e),anyNumber:g("*"),oneOrMore:g("+"),optional:g("?"),exactly:(e,...a)=>g(`{${e}}`)(...a),atLeast:(e,...a)=>g(`{${e},}`)(...a),between:(e,a,...n)=>g(`{${e},${a}}`)(...n),anyNumberNonGreedy:g("*?"),oneOrMoreNonGreedy:g("+?"),optionalNonGreedy:g("??"),exactlyNonGreedy:(e,...a)=>g(`{${e}}?`)(...a),atLeastNonGreedy:(e,...a)=>g(`{${e},}?`)(...a),betweenNonGreedy:(e,a,...n)=>g(`{${e},${a}}?`)(...n)};function u(e){return e.indexOf("|")>=0?i(e):e}function p(...e){return e.map(m).map(u)}function d(e){return(...a)=>c(e(...a),(e=>e),(e=>new RegExp(e)))}function f(e,a,n){return d(((...s)=>{const r=p(...s).join(a),o=t(r)?function(e){const a=/^\(\?:(.+)\)$/.exec(e);return a?a[1]:e}(r):r;return v(e,o,n)}))}function g(e){return d(((...a)=>v(i(o(...a)),e)))}function v(...e){return e.map(r).join("")}var w=[{name:"Genesis",aliases:["Gn","Gen"]},{name:"Exodus",aliases:["Exod","Ex","Exo"]},{name:"Leviticus",aliases:["Lv","Lev"]},{name:"Numbers",aliases:["Nu","Num","Numb"]},{name:"Deuteronomy",aliases:["Dt","Deut"]},{name:"Joshua",aliases:["Josh"]},{name:"Judges",aliases:["Judg"]},{name:"Ruth",aliases:[]},{name:"1 Samuel",aliases:["1 Sm","1 Sam","1st Sam","1st Samuel","First Samuel"]},{name:"2 Samuel",aliases:["2 Sm","2 Sam","2nd Sam","2nd Samuel","Second Samuel"]},{name:"1 Kings",aliases:["1 Ki","1 Kgs","1st Kgs","1st Kings","First Kings"]},{name:"2 Kings",aliases:["2 Ki","2 Kgs","2nd Kgs","2nd Kings","Second Kings"]},{name:"1 Chronicles",aliases:["1 Ch","1 Chr","1st Chr","1st Chronicles","First Chronicles"]},{name:"2 Chronicles",aliases:["2 Ch","2 Chr","2nd Chr","2nd Chronicles","Second Chronicles"]},{name:"Ezra",aliases:["Ezr"]},{name:"Nehemiah",aliases:["Ne","Neh"]},{name:"Esther",aliases:["Esth","Est"]},{name:"Job",aliases:[]},{name:"Psalms",aliases:["Ps","Pss","Psalm"]},{name:"Proverbs",aliases:["Prov","Pr","Pro"]},{name:"Ecclesiastes",aliases:["Eccl","Ec","Ecc"]},{name:"Song of Solomon",aliases:["Song","Song of Songs"]},{name:"Isaiah",aliases:["Is","Isa"]},{name:"Jeremiah",aliases:["Jer"]},{name:"Lamentations",aliases:["Lam"]},{name:"Ezekiel",aliases:["Ezk","Ezek"]},{name:"Daniel",aliases:["Dn","Dan"]},{name:"Hosea",aliases:["Ho","Hos"]},{name:"Joel",aliases:["Jl"]},{name:"Amos",aliases:["Am"]},{name:"Obadiah",aliases:["Obad","Ob","Oba"]},{name:"Jonah",aliases:["Jon"]},{name:"Micah",aliases:["Mc","Mi","Mic"]},{name:"Nahum",aliases:["Nah"]},{name:"Habakkuk",aliases:["Hab"]},{name:"Zephaniah",aliases:["Zp","Zeph"]},{name:"Haggai",aliases:["Hg","Hag"]},{name:"Zechariah",aliases:["Zc","Zech"]},{name:"Malachi",aliases:["Mal"]},{name:"Matthew",aliases:["Mt","Matt"]},{name:"Mark",aliases:["Mk"]},{name:"Luke",aliases:["Lk"]},{name:"John",aliases:["Jn"]},{name:"Acts",aliases:["Ac"]},{name:"Romans",aliases:["Ro","Rm","Rom"]},{name:"1 Corinthians",aliases:["1 Cor","1st Cor","1st Corinthians","First Corinthians"]},{name:"2 Corinthians",aliases:["2 Cor","2nd Cor","2nd Corinthians","Second Corinthians"]},{name:"Galatians",aliases:["Gal"]},{name:"Ephesians",aliases:["Eph"]},{name:"Philippians",aliases:["Ph","Phil"]},{name:"Colossians",aliases:["Col"]},{name:"1 Thessalonians",aliases:["1 Th","1 Thess","1st Thess","1st Thessalonians","First Thessalonians"]},{name:"2 Thessalonians",aliases:["2 Th","2 Thess","2nd Thess","2nd Thessalonians","Second Thessalonians"]},{name:"1 Timothy",aliases:["1 Tim","1st Tim","1st Timothy","First Timothy"]},{name:"2 Timothy",aliases:["2 Tim","2nd Tim","2nd Timothy","Second Timothy"]},{name:"Titus",aliases:["Tit"]},{name:"Philemon",aliases:["Phlm"]},{name:"Hebrews",aliases:["Heb"]},{name:"James",aliases:["Ja","Jas"]},{name:"1 Peter",aliases:["1 Pt","1 Pet","1st Pet","1st Peter","First Peter"]},{name:"2 Peter",aliases:["2 Pt","2 Pet","2nd Pet","2nd Peter","Second Peter"]},{name:"1 John",aliases:["1 Jn","1st John","First John"]},{name:"2 John",aliases:["2 Jn","2nd John","Second John"]},{name:"3 John",aliases:["3 Jn","3rd John","Third John"]},{name:"Jude",aliases:[]},{name:"Revelation",aliases:["Rv","Rev"]}];const{combine:S,flags:b,either:y,optional:E}=h;const J=function(e,a,n){var s=[];return Array.isArray(e)?(e.forEach((function(e,t,r){var o=a.call(n,e,t,r);Array.isArray(o)?s.push.apply(s,o):null!=o&&s.push(o)})),s):s},{either:C,capture:P,flags:$}=h,T=w,x=function({requireVerse:e=!1,flags:a="i"}={}){const n=/(\d+)([a-z])?/,s=S(":",n),t=S(/(\d+)/,e?s:E(s)),r=S("-",y(/([a-z])/,/(\d+)([a-z])/,t,n));return b(a,t,E(r))};var N={exports:{}};const k=j(w),R=e=>((e,a)=>void 0===e?I(a):e)(e,null),I=e=>"function"==typeof e?e():e,L=e=>null===e?e:parseInt(e,10);function M(e,a){const n=a?j(a):k,[,s,t,r,o,...i]=e,l=i.filter((e=>void 0!==e)),c={chapter:L(R(t)),verse:L(R(r)),section:R(o)},m=(h=3===l.length,u=()=>{const[e,a,n]=l;return{chapter:L(e),verse:L(a),section:R(n)}},p=()=>{const{numbers:e,section:a}=function(e){const a=e[e.length-1];return e.length>0&&/[a-z]/.test(a)?{numbers:e.slice(0,e.length-1).map(L),section:a}:{numbers:e.map(L),section:null}}(l);if(2===e.length){const[n,s]=e;return{chapter:n,verse:s,section:a}}return 1===e.length?null===c.verse?{chapter:e[0],verse:null,section:a}:{chapter:c.chapter,verse:e[0],section:a}:{chapter:c.chapter,verse:c.verse,section:a||c.section}},I(h)?I(u):I(p));var h,u,p,d;return{book:n[(d=s,"."===d[d.length-1]?d.substr(0,d.length-1):d).toLowerCase()].name,start:c,end:m}}function j(e){return e.reduce(((e,a)=>(e[a.name.toLowerCase()]=a,a.aliases.forEach((n=>e[n.toLowerCase()]=a)),e)),Object.create(null))}N.exports=M,N.exports.chapterVerseRange=e=>{const[,...a]=e;return Object.assign(M([null,"",...a],[{name:"",aliases:[]}]),{book:null})};const K=function({requireVerse:e=!1,flags:a="i",books:n=T}={}){const s=n.map((({name:e})=>e)),t=J(n,(({aliases:e})=>J(e,(e=>[e,e+"."])))),r=x({requireVerse:e,flags:a});return $(a,P(C(...s,...t))," ",r)}({flags:"gi"});const O=fetch("https://www.canonapi.com/v1/last_update.json").then((e=>e.text())).then((e=>{localStorage.getItem("last_update")!==e&&(localStorage.clear(),localStorage.setItem("last_update",e))}));function G(e){return e.toLowerCase().replace(/ /g,"").trim()}async function H(e){const{book:a,start:n,end:s}=e,t=function(e,a){if(a<e)throw new RangeError("start must be less than end");return new Array(a-e+1).fill().map(((a,n)=>e+n))}(n.chapter,s.chapter),r=await Promise.all(t.map((async e=>{const{verses:t}=await function(e,a){const n=G(e),s=w.find((({name:e,aliases:a})=>[e,...a].map(G).includes(n))),t=s&&s.name;return O.then((()=>{if(t){const e=G(t)+a,n=localStorage.getItem(e);return n?Promise.resolve({verses:JSON.parse(n),book_name:t}):fetch(`https://www.canonapi.com/v1/${G(t)}/${a}.json`).then((e=>{if(!e.ok)throw new Error(`Invalid chapter: ${t} ${a}`);return e.text()})).then((a=>(localStorage.setItem(e,a),{verses:JSON.parse(a),book_name:t})))}return Promise.reject(new Error(`Invalid book: ${e}`))}))}(a,e);let r=0;n.chapter===e&&n.verse&&(r=n.verse-1);let o=1/0;if(s.chapter===e&&s.verse&&(o=s.verse),t.length<=r)throw new Error(`Invalid verse: ${a} ${e}:${r+1}`);if(t.length<o&&o!==1/0){const n=o>t.length+1?t.length+1+"-":"";throw new Error(`Invalid verse${n?"s":""}: ${a} ${e}:${n}${o}`)}return t.slice(r,o).join("")})));let o=a+" "+n.chapter;return n.verse&&(o+=":"+n.verse),n.chapter!==s.chapter?(o+="-"+s.chapter,s.verse&&(o+=":"+s.verse)):s.verse&&s.verse!==n.verse&&(o+="-"+s.verse),{reference:o,text:r.join("")}}const A=document.querySelector("textarea"),z=document.querySelector("div.output");async function F(){const e=function(e){const a=[...e.matchAll(K)].map((e=>N.exports(e)));return a.forEach((e=>{const{start:a,end:n}=e;if(n.chapter<a.chapter)throw new Error("invalid chapter range");if(n.chapter===a.chapter&&n.verse<a.verse)throw new Error("invalid verse range");console.log(JSON.stringify(e))})),a}(A.value),a=await Promise.all(e.map((async e=>{try{const{reference:a,text:n}=await H(e);return{error:null,reference:a,text:n}}catch(e){return{error:e}}}))),n=a.map((({error:e,reference:a,text:n})=>e?`<span class="err">${e.message}</span>`:`<span class="verse"><span class="ref">${a}</span>${n}</span>`)).join("");z.innerHTML=n,document.location.hash=function(e){const a=e.filter((({error:e})=>!e)).map((({reference:e})=>e.replace(/:/g,".").replace(/ /g,"_"))).join("_");return"#"+encodeURIComponent(a)}(a)}var _;document.location.hash&&(A.value=(_=document.location.hash,decodeURIComponent(_.slice(1)).replace(/\./g,":").replace(/_/g," "))),A.oninput=F,F()}();
//# sourceMappingURL=bundle.js.map
